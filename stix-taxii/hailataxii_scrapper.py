import cabby
import xmltodict, json

client = cabby.create_client(
   # use_https=True,
    discovery_path='http://hailataxii.com/taxii-discovery-service/',version='1.1')

services = client.discover_services()
for service in services:
    print('Service type={s.type}, address={s.address}'
          .format(s=service))

collections = client.get_collections(uri='http://hailataxii.com/taxii-data')
for collection in collections:
    print(collection.name)
       
content_blocks = client.poll(collection_name='guest.phishtank_com')

for block in content_blocks:
    o = xmltodict.parse(block.content)
    print(json.dumps(o))
    break;
